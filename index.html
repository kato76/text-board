<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>éŸ³å£°å¾…æ©Ÿç”»é¢</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    padding-top: 60px;
  }

  #start {
    font-size: 28px;
    padding: 30px 50px;
  }

  #status {
    margin-top: 30px;
    font-size: 22px;
    color: green;
  }

  #text {
    margin-top: 20px;
    font-size: 26px;
    color: black;
  }
</style>
</head>
<body>

<button id="start">ç”»é¢ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„</button>

<div id="status"></div>
<div id="text"></div>

<script>
const SpeechRecognition =
  window.SpeechRecognition || window.webkitSpeechRecognition;

let recognition;
let started = false;

document.getElementById("start").onclick = () => {
  document.getElementById("start").style.display = "none";
  startMic();
};

function startMic() {
  recognition = new SpeechRecognition();
  recognition.lang = "ja-JP";
  recognition.continuous = true;        // â˜… é€£ç¶šèªè­˜
  recognition.interimResults = true;    // â˜… èªè­˜ä¸­è¡¨ç¤º

  recognition.onstart = () => {
    document.getElementById("status").textContent = "ğŸ¤ ãƒã‚¤ã‚¯å¾…æ©Ÿä¸­â€¦";
  };

  recognition.onresult = (event) => {
    let text = "";
    for (let i = event.resultIndex; i < event.results.length; i++) {
      text += event.results[i][0].transcript;
    }
    document.getElementById("text").textContent = text;
  };

  recognition.onerror = (e) => {
    document.getElementById("status").textContent =
      "âš  ãƒã‚¤ã‚¯ã‚¨ãƒ©ãƒ¼: " + e.error;
  };

  recognition.onend = () => {
    // â˜… å‹æ‰‹ã«æ­¢ã¾ã‚‹ã®ã§è‡ªå‹•å†é–‹ï¼ˆãƒ”ã‚³éŸ³ã—ãªã„ï¼‰
    if (started) {
      recognition.start();
    }
  };

  started = true;
  recognition.start();
}
</script>

</body>
</html>
