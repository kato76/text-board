<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      margin:0;
      background:black;
      color:white;
      font-family:sans-serif;
      display:flex;
      align-items:center;
      justify-content:center;
      height:100vh;
      font-size:8vw;
      text-align:center;
      white-space:pre-wrap;
    }
  </style>
</head>
<body>

<div id="text">待機中</div>

<script>

let lastRow = -1;
const t = document.getElementById("text");

function showText(msg){
  if(!msg) return;
  t.innerText = msg;
}

function poll(){
  google.script.run
    .withSuccessHandler(data=>{
      if(data.row > lastRow){
        lastRow = data.row;
        showText(data.text);
      }
    })
    .getLatest();
}

setInterval(poll, 1000);

</script>

</body>
</html>
